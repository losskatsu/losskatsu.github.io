---
title: "네트워크 기초(4) - OSI 7계층 - 3계층: 네트워크 계층" 
categories:
  - os-kernel
tags:
  - os
use_math: true
toc: true
toc_label: "My Table of Contents"
toc_icon: "cog"
sidebar:
  title: "AI Machine Learning"
  nav: sidebar-contents
---

# 네트워크 기초(4) - OSI 7계층 - 3계층: 네트워크 계층

**참고 링크**

* [네트워크 기초(1) - OSI 7계층이란?](https://losskatsu.github.io/os-kernel/network-basic01/)
* [네트워크 기초(2) - 1계층: 물리계층](https://losskatsu.github.io/os-kernel/network-basic02/)
* [네트워크 기초(3) - 2계층: 데이터 링크 계층](https://losskatsu.github.io/os-kernel/network-basic03/)
* [네트워크 기초(4) - 3계층: 네트워크 계층](https://losskatsu.github.io/os-kernel/network-basic04/)


## 1. 스위치 너머 저편으로

이번 포스팅에서는 OSI 7계층 중 3계층에 해당하는 네트워크 계층에 대해 알아보겠습니다. 

<center><img src="/assets/images/os/network-basic/network02.jpg" width="800"></center>

앞서 [데이터 링크 계층](https://losskatsu.github.io/os-kernel/network-basic03/)에서는 스위치라는 장비를 이용해 스위치에 연결되어 있는 
컴퓨터끼리 이더넷이라는 규칙하에 프레임을 주고 받았습니다. 
그러나 이러한 방법으로는 동일한 스위치에 연결되어 있는 컴퓨터끼리만 데이터를 전송할수 있습니다. 
즉, 스위치 너머에 있는 다른 네트워크로는 데이터를 전송할 수 없습니다. 


## 2. 라우터

하나의 스위치에 연결되어 있는 컴퓨터들의 모음을 하나의 '네트워크'라고 표현하겠습니다. 
그렇다면 서로다른 네트워크에 있는 컴퓨터들은 서로 어떻게 데이터를 주고받을 수 있을까요? 

이때 등장하는 것이 네트워크 계층입니다. 네트워크 계층은 서로 다른 네트워크 간의 통신을 가능하게 해줍니다. 
즉, 서로다른 네트워크에 속한 컴퓨터들끼리 데이터를 주고 받을 수 있다는 뜻입니다. 

1계층에서 허브라는 장비를 사용했고, 2계층에서 스위치라는 장비를 사용했다면 
3계층에서는 라우터(router)라는 장비를 사용합니다. 
2계층 데이터링크 계층에서는 데이터를 전송하기 위해 상대방 맥 주소가 필요했습니다. 
이와 비슷하게 3계층에서는 상대방의 IP 주소를 알아야 데이터를 전송할 수 있습니다. 
또한 목적지인 상대방 IP 주소 뿐만 아니라 어떤 경로로 보낼지도 결정해야하는데 이를 라우팅(routing)이라고 합니다. 

라우터는 거리에 상관없이 데이터를 보낼수 있습니다. 그리고 라우터에는 라우팅 테이블(routing table)을 이용해 
경로 정보를 등록, 관리 합니다. 

## 3. IP 주소 개요

네트워크 계층에서는 IP(Internet Protocol)라는 프로토콜을 사용합니다. 
그리고 네트워크 계층에서는 캡슐화할 때 IP 헤더를 붙입니다. 
IP헤더에는 버전, 헤더 길이, 서비스 유형, 전체 패킷 길이, ID, flags, fragment offset, TTL, 
프로토콜, 헤더체크섬, 출발지 IP, 목적지 IP 순서로 헤더가 구성되어 있습니다. 

이렇게 보내려고 하는 데이터에 IP 헤더를 포함한 것을 IP 패킷이라고 합니다. 
(참고로 데이터링크에서는 프레임이라고 불렀습니다.)

IP 주소는 ISP(인터넷 서비스 제공자)에게 받을 수 있습니다. 
ISP는 쉽게 말해 인터넷 사용하려고 신청한 통신사를 의미합니다. 

IP 버전은 IPv4, IPv6 두 종류가 있습니다. 
IPv4는 32비트로 구성되어 있으며, IPv6는 128비트로 구성되어 있습니다. 
기존에는 IPv4를 사용하다가 IP주소가 부족해서 만들어진것이 IPv6 입니다. 

IP주소는 2계층에서 배운 MAC 주소와는 비트 수가 다릅니다. 
MAC 주소는 48비트, 16진수로 표시하고, IP주소는 32비트 10진수로 표시합니다. 
물론 IP주소를 10진수로 표시하긴 하지만 이는 사람이 보기 편하기 위해 10진수로 표현하는 것이지 
실제 IP주소는 2진수로 되어 있습니다.
참고로 8비트를 옥텟(octet)이라고 부릅니다. 

따라서 요새는 IP가 부족한 상황이기 때문에 
ISP에서 주는 공인 IP주소는 라우터에만 할당하고 
랜에 속하는 호스트들은 사설 IP 주소를 받게 됩니다. 
이 때 사설 IP 주소는 원하는 주소를 할당할 수도 있고, 
DHCP(Dynamic Host Configuration Protocol) 기능을 이용해 자동으로 주소를 할당 할 수도 있습니다. 



## 3. IP 구조
